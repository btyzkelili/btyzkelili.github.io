---
layout:     post
title:      "Deep Learning"
subtitle:   "GCN"
date:       2019-07-24
author:     "btyzkelili"
header-img: "img/post-bg-nextgen-web-pwa.jpg"
header-mask: 0.3
catalog:    true
tags:
    - Deep Learning
---  
# 图卷积网络
设图有N个结点，每个节点有各自的特征，组成N * D维的特征矩阵X，各结点之间形成N * N维的邻接矩阵A，

网络层与层之间传播的方式是：
![](/img/dl_gcn/1.png)  
A˜：A + I<sub>N</sub>(单位矩阵)
D˜：A˜的度矩阵(degree matrix)，![](/img/dl_gcn/2.png)  
H<sup>l</sup>：第l层的输入特征，对于输入层，H=X
σ：非线性激活函数
其中，D˜<sup>-1/2</sup>A˜D˜<sup>-1/2</sup>可以预先计算出来，因为D˜由A˜得到，A˜由A和I得到，A是输入。

![](/img/dl_gcn/3.png)![](/img/dl_gcn/3.png)  
X和A作为网络的输入，整个训练过程中，**A不变**，输入结点的特征经过GCN之后从X变为Z，对所有带标签的节点计算cross entropy损失函数来调整网络参数，使得输出的Z更好的描述结点

## 为什么GCN的层与层传播方式是这样设置的？
假设图中没有自环，即A<sub>ii</sub>=0：
GCN本质是通过网络(graph)中的关联信息(edge)来得到节点的特征(node represent)
假如说，我们要根据X<sub>i</sub>的朋友圈来预测X<sub>i</sub>的工资：
![](/img/dl_gcn/6.png)  
1. 首先考虑，所有朋友的工资的平均值就是自己的工资，所以(平均数值需要对加和的系数归一化即可，后面完善)：
![](/img/dl_gcn/5.png)  
如果是无权图，A<sub>ij</sub>是0/1，如果j不在neighbor(i)中，A<sub>ij</sub>=0,所以，上式可写为：
![](/img/dl_gcn/7.png)  
矩阵形式：
![](/img/dl_gcn/8.png)  
2. 平均方法有一个问题：没有考虑到我们与不同朋友的亲密度是不同的




